# Generated by Django 5.2.5 on 2025-08-26 12:47

import cloudinary.models
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('lessons', '0001_initial'),
        ('schools', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Badge',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100)),
                ('name_arabic', models.CharField(max_length=100)),
                ('description', models.TextField()),
                ('description_arabic', models.TextField()),
                ('icon', models.CharField(help_text='Icon class or emoji', max_length=100)),
                ('color', models.CharField(default='#gold', max_length=7)),
                ('image', cloudinary.models.CloudinaryField(blank=True, max_length=255, null=True, verbose_name='image')),
                ('badge_type', models.CharField(choices=[('achievement', 'إنجاز - Achievement'), ('milestone', 'معلم - Milestone'), ('streak', 'سلسلة - Streak'), ('performance', 'أداء - Performance'), ('participation', 'مشاركة - Participation'), ('special', 'خاص - Special')], max_length=20)),
                ('rarity', models.CharField(choices=[('common', 'عادي - Common'), ('rare', 'نادر - Rare'), ('epic', 'ملحمي - Epic'), ('legendary', 'أسطوري - Legendary')], default='common', max_length=20)),
                ('requirements', models.JSONField(default=dict, help_text='Criteria to earn this badge')),
                ('points_reward', models.PositiveIntegerField(default=0)),
                ('coins_reward', models.PositiveIntegerField(default=0)),
                ('is_active', models.BooleanField(default=True)),
                ('is_hidden', models.BooleanField(default=False, help_text='Hidden until earned')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
        ),
        migrations.CreateModel(
            name='RewardType',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=50)),
                ('name_arabic', models.CharField(max_length=50)),
                ('category', models.CharField(choices=[('points', 'نقاط - Points'), ('coins', 'عملات - Coins'), ('gems', 'جواهر - Gems'), ('stars', 'نجوم - Stars'), ('xp', 'خبرة - XP')], max_length=20)),
                ('icon', models.CharField(help_text='Icon class or emoji', max_length=50)),
                ('color', models.CharField(default='#ffd700', help_text='Hex color', max_length=7)),
                ('is_active', models.BooleanField(default=True)),
            ],
        ),
        migrations.CreateModel(
            name='Assignment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200)),
                ('title_arabic', models.CharField(blank=True, max_length=200)),
                ('description', models.TextField()),
                ('instructions', models.TextField()),
                ('assignment_format', models.CharField(choices=[('mixed', 'مختلط - Format mixte'), ('qcm_only', 'أسئلة اختيار متعدد - QCM uniquement'), ('open_only', 'أسئلة مفتوحة - Questions ouvertes'), ('book_exercises', 'تمارين من الكتاب - Exercices du livre'), ('project', 'مشروع - Projet'), ('practical', 'تطبيقي - Travaux pratiques')], default='mixed', max_length=20)),
                ('assignment_type', models.CharField(choices=[('homework', 'واجب منزلي - Devoir à domicile'), ('classwork', 'عمل في القسم - Travail en classe'), ('quiz', 'اختبار قصير - Quiz'), ('exam', 'امتحان - Examen'), ('project', 'مشروع - Projet')], max_length=20)),
                ('assigned_date', models.DateTimeField(auto_now_add=True)),
                ('due_date', models.DateTimeField()),
                ('estimated_duration', models.PositiveIntegerField(help_text='Minutes')),
                ('time_limit', models.PositiveIntegerField(blank=True, help_text='Time limit in minutes', null=True)),
                ('is_timed', models.BooleanField(default=False)),
                ('total_points', models.DecimalField(decimal_places=2, default=20.0, max_digits=5)),
                ('auto_grade_qcm', models.BooleanField(default=True, help_text='Auto-grade QCM questions')),
                ('randomize_questions', models.BooleanField(default=False)),
                ('show_results_immediately', models.BooleanField(default=False)),
                ('allow_multiple_attempts', models.BooleanField(default=False)),
                ('max_attempts', models.PositiveIntegerField(default=1)),
                ('allow_late_submissions', models.BooleanField(default=True)),
                ('late_penalty_percentage', models.DecimalField(decimal_places=2, default=0.0, max_digits=5)),
                ('is_active', models.BooleanField(default=True)),
                ('is_published', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('grade', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assignments', to='schools.grade')),
                ('lesson', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='lessons.lesson')),
                ('school_class', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assignments', to='schools.schoolclass')),
                ('subject', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assignments', to='schools.subject')),
                ('teacher', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='created_assignments', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='AssignmentReward',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('completion_points', models.PositiveIntegerField(default=10)),
                ('completion_coins', models.PositiveIntegerField(default=1)),
                ('perfect_score_bonus', models.PositiveIntegerField(default=20, help_text='100% score bonus')),
                ('high_score_bonus', models.PositiveIntegerField(default=10, help_text='>=90% score bonus')),
                ('early_submission_bonus', models.PositiveIntegerField(default=10)),
                ('on_time_bonus', models.PositiveIntegerField(default=5)),
                ('difficulty_multiplier', models.DecimalField(decimal_places=2, default=1.0, max_digits=3)),
                ('weekend_multiplier', models.DecimalField(decimal_places=2, default=1.5, max_digits=3)),
                ('assignment', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='reward_config', to='homework.assignment')),
            ],
        ),
        migrations.CreateModel(
            name='BookExercise',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('book_title', models.CharField(max_length=200)),
                ('book_title_arabic', models.CharField(blank=True, max_length=200)),
                ('publisher', models.CharField(blank=True, max_length=100)),
                ('isbn', models.CharField(blank=True, max_length=20)),
                ('edition', models.CharField(blank=True, max_length=50)),
                ('chapter', models.CharField(help_text='Chapter name/number', max_length=100)),
                ('chapter_arabic', models.CharField(blank=True, max_length=100)),
                ('page_number', models.PositiveIntegerField(blank=True, null=True)),
                ('exercise_number', models.CharField(help_text="e.g., 'Exercise 5', '5.2', 'A-1'", max_length=50)),
                ('specific_questions', models.TextField(blank=True, help_text="e.g., 'Questions 1, 3, 5-8'")),
                ('additional_notes', models.TextField(blank=True)),
                ('page_image', cloudinary.models.CloudinaryField(blank=True, max_length=255, null=True, verbose_name='image')),
                ('points', models.DecimalField(decimal_places=2, default=5.0, max_digits=4)),
                ('assignment', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='book_exercises', to='homework.assignment')),
            ],
        ),
        migrations.CreateModel(
            name='BookExerciseAnswer',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('work_description', models.TextField(blank=True, help_text='Description of work done')),
                ('points_earned', models.DecimalField(blank=True, decimal_places=2, max_digits=4, null=True)),
                ('teacher_feedback', models.TextField(blank=True)),
                ('completed_at', models.DateTimeField(auto_now=True)),
                ('book_exercise', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='homework.bookexercise')),
            ],
        ),
        migrations.CreateModel(
            name='BookExerciseFile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('file', cloudinary.models.CloudinaryField(max_length=255, verbose_name='file')),
                ('filename', models.CharField(max_length=255)),
                ('file_type', models.CharField(max_length=50)),
                ('uploaded_at', models.DateTimeField(auto_now_add=True)),
                ('book_exercise_answer', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='files', to='homework.bookexerciseanswer')),
                ('uploaded_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='Leaderboard',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100)),
                ('leaderboard_type', models.CharField(choices=[('weekly', 'أسبوعي - Hebdomadaire'), ('monthly', 'شهري - Mensuel'), ('semester', 'فصل دراسي - Semestriel'), ('yearly', 'سنوي - Annuel')], max_length=20)),
                ('scope', models.CharField(choices=[('school', 'المدرسة - École'), ('grade', 'المستوى - Niveau'), ('class', 'القسم - Classe'), ('subject', 'المادة - Matière')], max_length=20)),
                ('start_date', models.DateField()),
                ('end_date', models.DateField()),
                ('is_active', models.BooleanField(default=True)),
                ('max_participants', models.PositiveIntegerField(default=50)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('grade', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='schools.grade')),
                ('school_class', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='schools.schoolclass')),
                ('subject', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='schools.subject')),
            ],
        ),
        migrations.CreateModel(
            name='Question',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('question_type', models.CharField(choices=[('qcm_single', 'اختيار من متعدد (إجابة واحدة) - QCM choix unique'), ('qcm_multiple', 'اختيار من متعدد (عدة إجابات) - QCM choix multiples'), ('open_short', 'سؤال مفتوح قصير - Question ouverte courte'), ('open_long', 'سؤال مفتوح طويل - Question ouverte longue'), ('true_false', 'صواب/خطأ - Vrai/Faux'), ('fill_blank', 'املأ الفراغ - Compléter'), ('matching', 'مطابقة - Appariement'), ('ordering', 'ترتيب - Classement')], max_length=20)),
                ('question_text', models.TextField()),
                ('question_text_arabic', models.TextField(blank=True)),
                ('question_image', cloudinary.models.CloudinaryField(blank=True, max_length=255, null=True, verbose_name='image')),
                ('explanation', models.TextField(blank=True, help_text='Explanation shown after answer')),
                ('explanation_arabic', models.TextField(blank=True)),
                ('points', models.DecimalField(decimal_places=2, default=1.0, max_digits=4)),
                ('order', models.PositiveIntegerField(default=0)),
                ('is_required', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('assignment', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='questions', to='homework.assignment')),
            ],
            options={
                'ordering': ['order', 'created_at'],
            },
        ),
        migrations.CreateModel(
            name='QuestionAnswer',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('text_answer', models.TextField(blank=True)),
                ('is_correct', models.BooleanField(blank=True, null=True)),
                ('points_earned', models.DecimalField(blank=True, decimal_places=2, max_digits=4, null=True)),
                ('teacher_feedback', models.TextField(blank=True)),
                ('answered_at', models.DateTimeField(auto_now=True)),
                ('question', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='homework.question')),
            ],
        ),
        migrations.CreateModel(
            name='AnswerFile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('file', cloudinary.models.CloudinaryField(max_length=255, verbose_name='file')),
                ('filename', models.CharField(max_length=255)),
                ('file_type', models.CharField(max_length=50)),
                ('uploaded_at', models.DateTimeField(auto_now_add=True)),
                ('uploaded_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
                ('question_answer', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='files', to='homework.questionanswer')),
            ],
        ),
        migrations.CreateModel(
            name='QuestionChoice',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('choice_text', models.CharField(max_length=500)),
                ('choice_text_arabic', models.CharField(blank=True, max_length=500)),
                ('choice_image', cloudinary.models.CloudinaryField(blank=True, max_length=255, null=True, verbose_name='image')),
                ('is_correct', models.BooleanField(default=False)),
                ('order', models.PositiveIntegerField(default=0)),
                ('question', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='choices', to='homework.question')),
            ],
            options={
                'ordering': ['order'],
            },
        ),
        migrations.AddField(
            model_name='questionanswer',
            name='selected_choices',
            field=models.ManyToManyField(blank=True, to='homework.questionchoice'),
        ),
        migrations.CreateModel(
            name='RewardSettings',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('points_per_correct_qcm', models.PositiveIntegerField(default=1)),
                ('points_per_assignment_completion', models.PositiveIntegerField(default=10)),
                ('points_perfect_score', models.PositiveIntegerField(default=20, help_text='Bonus for 100% score')),
                ('points_on_time_submission', models.PositiveIntegerField(default=5)),
                ('points_early_submission', models.PositiveIntegerField(default=10, help_text='Submitted >24h early')),
                ('late_submission_penalty', models.PositiveIntegerField(default=5)),
                ('points_to_coins_ratio', models.DecimalField(decimal_places=2, default=0.1, help_text='How many coins per point', max_digits=3)),
                ('enable_leaderboard', models.BooleanField(default=True)),
                ('enable_badges', models.BooleanField(default=True)),
                ('enable_weekly_reset', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('school', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='reward_settings', to='schools.school')),
            ],
        ),
        migrations.CreateModel(
            name='StudentWallet',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('total_points', models.PositiveIntegerField(default=0)),
                ('total_coins', models.PositiveIntegerField(default=0)),
                ('total_gems', models.PositiveIntegerField(default=0)),
                ('total_stars', models.PositiveIntegerField(default=0)),
                ('experience_points', models.PositiveIntegerField(default=0)),
                ('weekly_points', models.PositiveIntegerField(default=0)),
                ('weekly_coins', models.PositiveIntegerField(default=0)),
                ('current_week', models.DateField(auto_now_add=True)),
                ('monthly_points', models.PositiveIntegerField(default=0)),
                ('monthly_coins', models.PositiveIntegerField(default=0)),
                ('current_month', models.DateField(auto_now_add=True)),
                ('level', models.PositiveIntegerField(default=1)),
                ('assignments_completed', models.PositiveIntegerField(default=0)),
                ('perfect_scores', models.PositiveIntegerField(default=0)),
                ('early_submissions', models.PositiveIntegerField(default=0)),
                ('current_streak', models.PositiveIntegerField(default=0, help_text='Days with completed assignments')),
                ('longest_streak', models.PositiveIntegerField(default=0)),
                ('last_activity', models.DateField(auto_now=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('student', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='wallet', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='Submission',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('status', models.CharField(choices=[('draft', 'مسودة - Brouillon'), ('in_progress', 'قيد التقدم - En cours'), ('submitted', 'مُسلم - Soumis'), ('late', 'متأخر - En retard'), ('auto_graded', 'مُصحح تلقائياً - Auto-corrigé'), ('manually_graded', 'مُصحح يدوياً - Corrigé manuellement')], default='draft', max_length=20)),
                ('started_at', models.DateTimeField(blank=True, null=True)),
                ('submitted_at', models.DateTimeField(blank=True, null=True)),
                ('time_taken', models.PositiveIntegerField(blank=True, help_text='Minutes taken', null=True)),
                ('attempt_number', models.PositiveIntegerField(default=1)),
                ('is_late', models.BooleanField(default=False)),
                ('total_score', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('auto_score', models.DecimalField(blank=True, decimal_places=2, help_text='QCM auto-graded score', max_digits=5, null=True)),
                ('manual_score', models.DecimalField(blank=True, decimal_places=2, help_text='Manual grading score', max_digits=5, null=True)),
                ('points_earned', models.PositiveIntegerField(default=0)),
                ('coins_earned', models.PositiveIntegerField(default=0)),
                ('bonus_points', models.PositiveIntegerField(default=0)),
                ('rewards_calculated', models.BooleanField(default=False)),
                ('teacher_feedback', models.TextField(blank=True)),
                ('graded_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('assignment', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='submissions', to='homework.assignment')),
                ('graded_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='graded_submissions', to=settings.AUTH_USER_MODEL)),
                ('student', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='submissions', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-created_at'],
                'unique_together': {('assignment', 'student', 'attempt_number')},
            },
        ),
        migrations.CreateModel(
            name='RewardTransaction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('transaction_type', models.CharField(choices=[('earned', 'مكتسب - Gagné'), ('bonus', 'مكافأة - Bonus'), ('penalty', 'خصم - Pénalité'), ('spent', 'مصروف - Dépensé'), ('gift', 'هدية - Cadeau'), ('achievement', 'إنجاز - Achievement')], max_length=20)),
                ('points_earned', models.IntegerField(default=0)),
                ('coins_earned', models.IntegerField(default=0)),
                ('gems_earned', models.IntegerField(default=0)),
                ('stars_earned', models.IntegerField(default=0)),
                ('xp_earned', models.IntegerField(default=0)),
                ('reason', models.CharField(help_text='Why this reward was given', max_length=200)),
                ('reason_arabic', models.CharField(blank=True, max_length=200)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('assignment', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='homework.assignment')),
                ('awarded_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='awarded_rewards', to=settings.AUTH_USER_MODEL)),
                ('student', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='reward_transactions', to=settings.AUTH_USER_MODEL)),
                ('submission', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='homework.submission')),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='questionanswer',
            name='submission',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='answers', to='homework.submission'),
        ),
        migrations.AddField(
            model_name='bookexerciseanswer',
            name='submission',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='book_exercise_answers', to='homework.submission'),
        ),
        migrations.CreateModel(
            name='LeaderboardEntry',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('current_rank', models.PositiveIntegerField()),
                ('previous_rank', models.PositiveIntegerField(blank=True, null=True)),
                ('total_points', models.PositiveIntegerField()),
                ('total_coins', models.PositiveIntegerField()),
                ('assignments_completed', models.PositiveIntegerField(default=0)),
                ('perfect_scores', models.PositiveIntegerField(default=0)),
                ('points_this_period', models.PositiveIntegerField(default=0)),
                ('rank_change', models.IntegerField(default=0, help_text='Positive = moved up, Negative = moved down')),
                ('last_updated', models.DateTimeField(auto_now=True)),
                ('leaderboard', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='entries', to='homework.leaderboard')),
                ('student', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['current_rank'],
                'unique_together': {('leaderboard', 'student')},
            },
        ),
        migrations.CreateModel(
            name='StudentBadge',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('earned_at', models.DateTimeField(auto_now_add=True)),
                ('earned_for', models.CharField(blank=True, help_text='What triggered this badge', max_length=200)),
                ('assignment', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='homework.assignment')),
                ('badge', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='homework.badge')),
                ('student', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='earned_badges', to=settings.AUTH_USER_MODEL)),
                ('submission', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='homework.submission')),
            ],
            options={
                'ordering': ['-earned_at'],
                'unique_together': {('student', 'badge')},
            },
        ),
        migrations.AlterUniqueTogether(
            name='questionanswer',
            unique_together={('submission', 'question')},
        ),
        migrations.AlterUniqueTogether(
            name='bookexerciseanswer',
            unique_together={('submission', 'book_exercise')},
        ),
        migrations.CreateModel(
            name='TextbookLibrary',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200)),
                ('title_arabic', models.CharField(blank=True, max_length=200)),
                ('publisher', models.CharField(max_length=100)),
                ('isbn', models.CharField(max_length=20, unique=True)),
                ('cover_image', cloudinary.models.CloudinaryField(blank=True, max_length=255, null=True, verbose_name='image')),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('grade', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='schools.grade')),
                ('subject', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='schools.subject')),
            ],
            options={
                'unique_together': {('subject', 'grade', 'title')},
            },
        ),
        migrations.CreateModel(
            name='WeeklyLeaderboardSnapshot',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('week_start', models.DateField()),
                ('week_end', models.DateField()),
                ('top_students', models.JSONField(default=list, help_text='Top 10 students with scores')),
                ('total_participants', models.PositiveIntegerField(default=0)),
                ('total_points_awarded', models.PositiveIntegerField(default=0)),
                ('average_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('grade', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='schools.grade')),
            ],
            options={
                'unique_together': {('week_start', 'grade')},
            },
        ),
    ]
