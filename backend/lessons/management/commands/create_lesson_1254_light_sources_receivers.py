"""
Django management command to create exercises for Lesson 1254: Light Sources and Optical Receivers
Generated by: generate_batch24_physics.py
"""

from django.core.management.base import BaseCommand
from lessons.models import Lesson
from homework.models import Exercise, Question, QuestionChoice
from users.models import User


class Command(BaseCommand):
    help = 'Create exercises for Lesson 1254: Light Sources and Optical Receivers'

    def handle(self, *args, **options):
        try:
            lesson = Lesson.objects.get(id=1254)
        except Lesson.DoesNotExist:
            self.stdout.write(self.style.ERROR(f'Lesson 1254 not found'))
            return

        admin_user = User.objects.filter(is_superuser=True).first()
        if not admin_user:
            self.stdout.write(self.style.ERROR('No admin user found'))
            return

        exercises_data = [{'title': 'Natural Light Sources', 'title_ar': 'المصادر الطبيعية للضوء', 'difficulty': 'beginner', 'points': 12, 'questions': [{'text': 'Natural Light Sources - Question 1', 'text_ar': 'المصادر الطبيعية للضوء - السؤال 1', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Natural Light Sources - Question 2', 'text_ar': 'المصادر الطبيعية للضوء - السؤال 2', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Natural Light Sources - Question 3', 'text_ar': 'المصادر الطبيعية للضوء - السؤال 3', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Natural Light Sources - Question 4', 'text_ar': 'المصادر الطبيعية للضوء - السؤال 4', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Natural Light Sources - Question 5', 'text_ar': 'المصادر الطبيعية للضوء - السؤال 5', 'question_type': 'qcm_multiple', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Natural Light Sources - Question 6', 'text_ar': 'المصادر الطبيعية للضوء - السؤال 6', 'question_type': 'true_false', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}]}, {'title': 'Artificial Light Sources', 'title_ar': 'المصادر الصناعية للضوء', 'difficulty': 'beginner', 'points': 12, 'questions': [{'text': 'Artificial Light Sources - Question 1', 'text_ar': 'المصادر الصناعية للضوء - السؤال 1', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Artificial Light Sources - Question 2', 'text_ar': 'المصادر الصناعية للضوء - السؤال 2', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Artificial Light Sources - Question 3', 'text_ar': 'المصادر الصناعية للضوء - السؤال 3', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Artificial Light Sources - Question 4', 'text_ar': 'المصادر الصناعية للضوء - السؤال 4', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Artificial Light Sources - Question 5', 'text_ar': 'المصادر الصناعية للضوء - السؤال 5', 'question_type': 'qcm_multiple', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Artificial Light Sources - Question 6', 'text_ar': 'المصادر الصناعية للضوء - السؤال 6', 'question_type': 'true_false', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}]}, {'title': 'Optical Receivers and the Eye', 'title_ar': 'المستقبلات الضوئية والعين', 'difficulty': 'intermediate', 'points': 12, 'questions': [{'text': 'Optical Receivers and the Eye - Question 1', 'text_ar': 'المستقبلات الضوئية والعين - السؤال 1', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Optical Receivers and the Eye - Question 2', 'text_ar': 'المستقبلات الضوئية والعين - السؤال 2', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Optical Receivers and the Eye - Question 3', 'text_ar': 'المستقبلات الضوئية والعين - السؤال 3', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Optical Receivers and the Eye - Question 4', 'text_ar': 'المستقبلات الضوئية والعين - السؤال 4', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Optical Receivers and the Eye - Question 5', 'text_ar': 'المستقبلات الضوئية والعين - السؤال 5', 'question_type': 'qcm_multiple', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Optical Receivers and the Eye - Question 6', 'text_ar': 'المستقبلات الضوئية والعين - السؤال 6', 'question_type': 'true_false', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}]}, {'title': 'Properties of Light', 'title_ar': 'خصائص الضوء', 'difficulty': 'intermediate', 'points': 12, 'questions': [{'text': 'Properties of Light - Question 1', 'text_ar': 'خصائص الضوء - السؤال 1', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Properties of Light - Question 2', 'text_ar': 'خصائص الضوء - السؤال 2', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Properties of Light - Question 3', 'text_ar': 'خصائص الضوء - السؤال 3', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Properties of Light - Question 4', 'text_ar': 'خصائص الضوء - السؤال 4', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Properties of Light - Question 5', 'text_ar': 'خصائص الضوء - السؤال 5', 'question_type': 'qcm_multiple', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Properties of Light - Question 6', 'text_ar': 'خصائص الضوء - السؤال 6', 'question_type': 'true_false', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}]}, {'title': 'Light Propagation', 'title_ar': 'انتشار الضوء', 'difficulty': 'advanced', 'points': 12, 'questions': [{'text': 'Light Propagation - Question 1', 'text_ar': 'انتشار الضوء - السؤال 1', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Light Propagation - Question 2', 'text_ar': 'انتشار الضوء - السؤال 2', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Light Propagation - Question 3', 'text_ar': 'انتشار الضوء - السؤال 3', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Light Propagation - Question 4', 'text_ar': 'انتشار الضوء - السؤال 4', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Light Propagation - Question 5', 'text_ar': 'انتشار الضوء - السؤال 5', 'question_type': 'qcm_multiple', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Light Propagation - Question 6', 'text_ar': 'انتشار الضوء - السؤال 6', 'question_type': 'true_false', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}]}]

        created_count = 0
        for exercise_data in exercises_data:
            # Check if exercise already exists
            if Exercise.objects.filter(
                lesson=lesson,
                title=exercise_data['title']
            ).exists():
                self.stdout.write(
                    self.style.WARNING(
                        f'Exercise "{exercise_data["title"]}" already exists, skipping...'
                    )
                )
                continue

            # Create exercise
            exercise = Exercise.objects.create(
                lesson=lesson,
                title=exercise_data['title'],
                title_arabic=exercise_data['title_ar'],
                difficulty_level=exercise_data['difficulty'],
                total_points=exercise_data['points'],
                created_by=admin_user
            )

            # Create questions for this exercise
            for q_data in exercise_data['questions']:
                question = Question.objects.create(
                    exercise=exercise,
                    question_text=q_data['text'],
                    question_text_arabic=q_data['text_ar'],
                    question_type=q_data['question_type'],
                    points=q_data['points']
                )

                # Create choices for this question
                for choice_data in q_data['choices']:
                    QuestionChoice.objects.create(
                        question=question,
                        choice_text=choice_data['text'],
                        choice_text_arabic=choice_data['text_ar'],
                        is_correct=choice_data['is_correct']
                    )

            created_count += 1
            self.stdout.write(
                self.style.SUCCESS(
                    f'Created exercise: {exercise.title} with {len(exercise_data["questions"])} questions'
                )
            )

        self.stdout.write(
            self.style.SUCCESS(
                f'Successfully created {created_count} exercises for lesson: Light Sources and Optical Receivers'
            )
        )
