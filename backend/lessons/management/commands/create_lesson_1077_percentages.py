"""
Django management command to create exercises for Lesson 1077: Percentages
Generated by: generate_batch26_math.py
"""

from django.core.management.base import BaseCommand
from lessons.models import Lesson
from homework.models import Exercise, Question, QuestionChoice
from users.models import User


class Command(BaseCommand):
    help = 'Create exercises for Lesson 1077: Percentages'

    def handle(self, *args, **options):
        try:
            lesson = Lesson.objects.get(id=1077)
        except Lesson.DoesNotExist:
            self.stdout.write(self.style.ERROR(f'Lesson 1077 not found'))
            return

        admin_user = User.objects.filter(is_superuser=True).first()
        if not admin_user:
            self.stdout.write(self.style.ERROR('No admin user found'))
            return

        exercises_data = [{'title': 'Understanding Percentages', 'title_ar': 'فهم النسب المئوية', 'difficulty': 'beginner', 'points': 12, 'questions': [{'text': 'Understanding Percentages - Question 1', 'text_ar': 'فهم النسب المئوية - السؤال 1', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Understanding Percentages - Question 2', 'text_ar': 'فهم النسب المئوية - السؤال 2', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Understanding Percentages - Question 3', 'text_ar': 'فهم النسب المئوية - السؤال 3', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Understanding Percentages - Question 4', 'text_ar': 'فهم النسب المئوية - السؤال 4', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Understanding Percentages - Question 5', 'text_ar': 'فهم النسب المئوية - السؤال 5', 'question_type': 'qcm_multiple', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Understanding Percentages - Question 6', 'text_ar': 'فهم النسب المئوية - السؤال 6', 'question_type': 'true_false', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}]}, {'title': 'Converting Fractions to Percentages', 'title_ar': 'تحويل الكسور إلى نسب مئوية', 'difficulty': 'beginner', 'points': 12, 'questions': [{'text': 'Converting Fractions to Percentages - Question 1', 'text_ar': 'تحويل الكسور إلى نسب مئوية - السؤال 1', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Converting Fractions to Percentages - Question 2', 'text_ar': 'تحويل الكسور إلى نسب مئوية - السؤال 2', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Converting Fractions to Percentages - Question 3', 'text_ar': 'تحويل الكسور إلى نسب مئوية - السؤال 3', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Converting Fractions to Percentages - Question 4', 'text_ar': 'تحويل الكسور إلى نسب مئوية - السؤال 4', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Converting Fractions to Percentages - Question 5', 'text_ar': 'تحويل الكسور إلى نسب مئوية - السؤال 5', 'question_type': 'qcm_multiple', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Converting Fractions to Percentages - Question 6', 'text_ar': 'تحويل الكسور إلى نسب مئوية - السؤال 6', 'question_type': 'true_false', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}]}, {'title': 'Calculating Percentages', 'title_ar': 'حساب النسب المئوية', 'difficulty': 'intermediate', 'points': 12, 'questions': [{'text': 'Calculating Percentages - Question 1', 'text_ar': 'حساب النسب المئوية - السؤال 1', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Calculating Percentages - Question 2', 'text_ar': 'حساب النسب المئوية - السؤال 2', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Calculating Percentages - Question 3', 'text_ar': 'حساب النسب المئوية - السؤال 3', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Calculating Percentages - Question 4', 'text_ar': 'حساب النسب المئوية - السؤال 4', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Calculating Percentages - Question 5', 'text_ar': 'حساب النسب المئوية - السؤال 5', 'question_type': 'qcm_multiple', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Calculating Percentages - Question 6', 'text_ar': 'حساب النسب المئوية - السؤال 6', 'question_type': 'true_false', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}]}, {'title': 'Percentage Increase and Decrease', 'title_ar': 'الزيادة والنقصان المئوي', 'difficulty': 'intermediate', 'points': 12, 'questions': [{'text': 'Percentage Increase and Decrease - Question 1', 'text_ar': 'الزيادة والنقصان المئوي - السؤال 1', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Percentage Increase and Decrease - Question 2', 'text_ar': 'الزيادة والنقصان المئوي - السؤال 2', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Percentage Increase and Decrease - Question 3', 'text_ar': 'الزيادة والنقصان المئوي - السؤال 3', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Percentage Increase and Decrease - Question 4', 'text_ar': 'الزيادة والنقصان المئوي - السؤال 4', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Percentage Increase and Decrease - Question 5', 'text_ar': 'الزيادة والنقصان المئوي - السؤال 5', 'question_type': 'qcm_multiple', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Percentage Increase and Decrease - Question 6', 'text_ar': 'الزيادة والنقصان المئوي - السؤال 6', 'question_type': 'true_false', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}]}, {'title': 'Real-Life Percentage Problems', 'title_ar': 'مسائل النسب المئوية في الحياة', 'difficulty': 'advanced', 'points': 12, 'questions': [{'text': 'Real-Life Percentage Problems - Question 1', 'text_ar': 'مسائل النسب المئوية في الحياة - السؤال 1', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Real-Life Percentage Problems - Question 2', 'text_ar': 'مسائل النسب المئوية في الحياة - السؤال 2', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Real-Life Percentage Problems - Question 3', 'text_ar': 'مسائل النسب المئوية في الحياة - السؤال 3', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Real-Life Percentage Problems - Question 4', 'text_ar': 'مسائل النسب المئوية في الحياة - السؤال 4', 'question_type': 'qcm_single', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Real-Life Percentage Problems - Question 5', 'text_ar': 'مسائل النسب المئوية في الحياة - السؤال 5', 'question_type': 'qcm_multiple', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}, {'text': 'Real-Life Percentage Problems - Question 6', 'text_ar': 'مسائل النسب المئوية في الحياة - السؤال 6', 'question_type': 'true_false', 'points': 2, 'choices': [{'text': 'Option A', 'text_ar': 'الخيار أ', 'is_correct': True}, {'text': 'Option B', 'text_ar': 'الخيار ب', 'is_correct': False}, {'text': 'Option C', 'text_ar': 'الخيار ج', 'is_correct': False}, {'text': 'Option D', 'text_ar': 'الخيار د', 'is_correct': False}]}]}]

        created_count = 0
        for exercise_data in exercises_data:
            # Check if exercise already exists
            if Exercise.objects.filter(
                lesson=lesson,
                title=exercise_data['title']
            ).exists():
                self.stdout.write(
                    self.style.WARNING(
                        f'Exercise "{exercise_data["title"]}" already exists, skipping...'
                    )
                )
                continue

            # Create exercise
            exercise = Exercise.objects.create(
                lesson=lesson,
                title=exercise_data['title'],
                title_arabic=exercise_data['title_ar'],
                difficulty_level=exercise_data['difficulty'],
                total_points=exercise_data['points'],
                created_by=admin_user
            )

            # Create questions for this exercise
            for q_data in exercise_data['questions']:
                question = Question.objects.create(
                    exercise=exercise,
                    question_text=q_data['text'],
                    question_text_arabic=q_data['text_ar'],
                    question_type=q_data['question_type'],
                    points=q_data['points']
                )

                # Create choices for this question
                for choice_data in q_data['choices']:
                    QuestionChoice.objects.create(
                        question=question,
                        choice_text=choice_data['text'],
                        choice_text_arabic=choice_data['text_ar'],
                        is_correct=choice_data['is_correct']
                    )

            created_count += 1
            self.stdout.write(
                self.style.SUCCESS(
                    f'Created exercise: {exercise.title} with {len(exercise_data["questions"])} questions'
                )
            )

        self.stdout.write(
            self.style.SUCCESS(
                f'Successfully created {created_count} exercises for lesson: Percentages'
            )
        )
